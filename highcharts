import pandas as pd

# Ścieżka do pliku Excel
file_path = "ścieżka_do_pliku.xlsx"  # Zamień na rzeczywistą ścieżkę do pliku
sheet_name = "AaA_TB"

# Wczytaj dane z Excela
df = pd.read_excel(file_path, sheet_name=sheet_name)

# Konwertuj dane na format Highcharts
data = []
for _, row in df.iterrows():
    entity = row["reporting_entity_name"]
    property_ = row["property_name"]
    company = row["company_name"]

    # Dodaj połączenia
    data.append({"from": entity, "to": property_})
    data.append({"from": property_, "to": company})

# Generowanie pliku HTML
html_template = f"""
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchiczny Graf Struktury Firm</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/networkgraph.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
</head>
<body>
    <div id="container" style="width: 100%; height: 600px;"></div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {{
            // Dane do grafu
            const data = {data};

            // Konfiguracja Highcharts
            Highcharts.chart('container', {{
                chart: {{
                    type: 'networkgraph',
                    marginTop: 80
                }},
                title: {{
                    text: 'Hierarchiczny Graf Struktury Firm'
                }},
                plotOptions: {{
                    networkgraph: {{
                        layoutAlgorithm: {{
                            enableSimulation: true,
                            linkLength: 100
                        }}
                    }}
                }},
                series: [{{
                    marker: {{
                        radius: 10
                    }},
                    dataLabels: {{
                        enabled: true,
                        linkFormat: '',
                        allowOverlap: true
                    }},
                    data: data
                }}]
            }});
        }});
    </script>
</body>
</html>
"""

# Zapis pliku HTML
with open("index.html", "w", encoding="utf-8") as file:
    file.write(html_template)

print("Plik HTML został wygenerowany jako 'index.html'.")
